{"ast":null,"code":"import { CollectionRendererContext as $7135fc7d473fd974$export$4feb769f8ddf26c5 } from \"./Collection.mjs\";\nimport { useVirtualizerState as $dVUg9$useVirtualizerState } from \"@react-stately/virtualizer\";\nimport $dVUg9$react, { createContext as $dVUg9$createContext, useMemo as $dVUg9$useMemo, useContext as $dVUg9$useContext } from \"react\";\nimport { useScrollView as $dVUg9$useScrollView, VirtualizerItem as $dVUg9$VirtualizerItem } from \"@react-aria/virtualizer\";\n\n/*\n * Copyright 2024 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nconst $ce3a951440fc273f$var$VirtualizerContext = /*#__PURE__*/(0, $dVUg9$createContext)(null);\nconst $ce3a951440fc273f$var$LayoutContext = /*#__PURE__*/(0, $dVUg9$createContext)(null);\nfunction $ce3a951440fc273f$export$89be5a243e59c4b2(props) {\n  let {\n    children: children,\n    layout: layout,\n    layoutOptions: layoutOptions\n  } = props;\n  let renderer = (0, $dVUg9$useMemo)(() => ({\n    isVirtualized: true,\n    layoutDelegate: layout,\n    dropTargetDelegate: layout.getDropTargetFromPoint ? layout : undefined,\n    CollectionRoot: $ce3a951440fc273f$var$CollectionRoot,\n    CollectionBranch: $ce3a951440fc273f$var$CollectionBranch\n  }), [layout]);\n  return /*#__PURE__*/(0, $dVUg9$react).createElement((0, $7135fc7d473fd974$export$4feb769f8ddf26c5).Provider, {\n    value: renderer\n  }, /*#__PURE__*/(0, $dVUg9$react).createElement($ce3a951440fc273f$var$LayoutContext.Provider, {\n    value: {\n      layout: layout,\n      layoutOptions: layoutOptions\n    }\n  }, children));\n}\nfunction $ce3a951440fc273f$var$CollectionRoot({\n  collection: collection,\n  persistedKeys: persistedKeys,\n  scrollRef: scrollRef,\n  renderDropIndicator: renderDropIndicator\n}) {\n  var _layout_useLayoutOptions;\n  let {\n    layout: layout,\n    layoutOptions: layoutOptions\n  } = (0, $dVUg9$useContext)($ce3a951440fc273f$var$LayoutContext);\n  let layoutOptions2 = (_layout_useLayoutOptions = layout.useLayoutOptions) === null || _layout_useLayoutOptions === void 0 ? void 0 : _layout_useLayoutOptions.call(layout);\n  let state = (0, $dVUg9$useVirtualizerState)({\n    layout: layout,\n    collection: collection,\n    renderView: (type, item) => {\n      var _item_render;\n      return item === null || item === void 0 ? void 0 : (_item_render = item.render) === null || _item_render === void 0 ? void 0 : _item_render.call(item, item);\n    },\n    onVisibleRectChange(rect) {\n      let element = scrollRef === null || scrollRef === void 0 ? void 0 : scrollRef.current;\n      if (element) {\n        element.scrollLeft = rect.x;\n        element.scrollTop = rect.y;\n      }\n    },\n    persistedKeys: persistedKeys,\n    layoutOptions: (0, $dVUg9$useMemo)(() => {\n      if (layoutOptions && layoutOptions2) return {\n        ...layoutOptions,\n        ...layoutOptions2\n      };\n      return layoutOptions || layoutOptions2;\n    }, [layoutOptions, layoutOptions2])\n  });\n  let {\n    contentProps: contentProps\n  } = (0, $dVUg9$useScrollView)({\n    onVisibleRectChange: state.setVisibleRect,\n    contentSize: state.contentSize,\n    onScrollStart: state.startScrolling,\n    onScrollEnd: state.endScrolling\n  }, scrollRef);\n  if (state.contentSize.area === 0) return null;\n  return /*#__PURE__*/(0, $dVUg9$react).createElement(\"div\", contentProps, /*#__PURE__*/(0, $dVUg9$react).createElement($ce3a951440fc273f$var$VirtualizerContext.Provider, {\n    value: state\n  }, $ce3a951440fc273f$var$renderChildren(null, state.visibleViews, renderDropIndicator)));\n}\nfunction $ce3a951440fc273f$var$CollectionBranch({\n  parent: parent,\n  renderDropIndicator: renderDropIndicator\n}) {\n  let virtualizer = (0, $dVUg9$useContext)($ce3a951440fc273f$var$VirtualizerContext);\n  let parentView = virtualizer.virtualizer.getVisibleView(parent.key);\n  return $ce3a951440fc273f$var$renderChildren(parentView, Array.from(parentView.children), renderDropIndicator);\n}\nfunction $ce3a951440fc273f$var$renderChildren(parent, children, renderDropIndicator) {\n  return children.map(view => $ce3a951440fc273f$var$renderWrapper(parent, view, renderDropIndicator));\n}\nfunction $ce3a951440fc273f$var$renderWrapper(parent, reusableView, renderDropIndicator) {\n  let rendered = /*#__PURE__*/(0, $dVUg9$react).createElement((0, $dVUg9$VirtualizerItem), {\n    key: reusableView.key,\n    layoutInfo: reusableView.layoutInfo,\n    virtualizer: reusableView.virtualizer,\n    parent: parent === null || parent === void 0 ? void 0 : parent.layoutInfo\n  }, reusableView.rendered);\n  let {\n    collection: collection,\n    layout: layout\n  } = reusableView.virtualizer;\n  let {\n    key: key,\n    type: type\n  } = reusableView.content;\n  if (type === 'item' && renderDropIndicator && layout.getDropTargetLayoutInfo) rendered = /*#__PURE__*/(0, $dVUg9$react).createElement((0, $dVUg9$react).Fragment, {\n    key: reusableView.key\n  }, $ce3a951440fc273f$var$renderDropIndicatorWrapper(parent, reusableView, 'before', renderDropIndicator), rendered, collection.getKeyAfter(key) == null && $ce3a951440fc273f$var$renderDropIndicatorWrapper(parent, reusableView, 'after', renderDropIndicator));\n  return rendered;\n}\nfunction $ce3a951440fc273f$var$renderDropIndicatorWrapper(parent, reusableView, dropPosition, renderDropIndicator) {\n  let target = {\n    type: 'item',\n    key: reusableView.content.key,\n    dropPosition: dropPosition\n  };\n  let indicator = renderDropIndicator(target);\n  if (indicator) {\n    let layoutInfo = reusableView.virtualizer.layout.getDropTargetLayoutInfo(target);\n    indicator = /*#__PURE__*/(0, $dVUg9$react).createElement((0, $dVUg9$VirtualizerItem), {\n      layoutInfo: layoutInfo,\n      virtualizer: reusableView.virtualizer,\n      parent: parent === null || parent === void 0 ? void 0 : parent.layoutInfo\n    }, indicator);\n  }\n  return indicator;\n}\nexport { $ce3a951440fc273f$export$89be5a243e59c4b2 as Virtualizer };","map":{"version":3,"names":["$ce3a951440fc273f$var$VirtualizerContext","$dVUg9$createContext","$ce3a951440fc273f$var$LayoutContext","$ce3a951440fc273f$export$89be5a243e59c4b2","props","children","layout","layoutOptions","renderer","$dVUg9$useMemo","isVirtualized","layoutDelegate","dropTargetDelegate","getDropTargetFromPoint","undefined","$ce3a951440fc273f$var$CollectionRoot","$ce3a951440fc273f$var$CollectionBranch","$dVUg9$react","createElement","$7135fc7d473fd974$export$4feb769f8ddf26c5","Provider","value","collection","persistedKeys","scrollRef","renderDropIndicator","_layout_useLayoutOptions","$dVUg9$useContext","layoutOptions2","useLayoutOptions","call","state","$dVUg9$useVirtualizerState","renderView","type","item","_item_render","render","onVisibleRectChange","rect","element","current","scrollLeft","x","scrollTop","y","contentProps","$dVUg9$useScrollView","setVisibleRect","contentSize","onScrollStart","startScrolling","onScrollEnd","endScrolling","area","$ce3a951440fc273f$var$renderChildren","visibleViews","parent","virtualizer","parentView","getVisibleView","key","Array","from","map","view","$ce3a951440fc273f$var$renderWrapper","reusableView","rendered","$dVUg9$VirtualizerItem","layoutInfo","content","getDropTargetLayoutInfo","Fragment","$ce3a951440fc273f$var$renderDropIndicatorWrapper","getKeyAfter","dropPosition","target","indicator"],"sources":["/Users/oscar.meunier/Documents/Personal/goodreads/node_modules/react-aria-components/dist/packages/react-aria-components/src/Virtualizer.tsx"],"sourcesContent":["/*\n * Copyright 2024 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport {CollectionBranchProps, CollectionRenderer, CollectionRendererContext, CollectionRootProps} from './Collection';\nimport {DropPosition, DropTarget, DropTargetDelegate, ItemDropTarget, Node} from '@react-types/shared';\nimport {Layout, ReusableView, useVirtualizerState, VirtualizerState} from '@react-stately/virtualizer';\nimport React, {createContext, ReactElement, ReactNode, useContext, useMemo} from 'react';\nimport {useScrollView, VirtualizerItem} from '@react-aria/virtualizer';\n\ntype View = ReusableView<Node<unknown>, ReactNode>;\n\nexport interface LayoutOptionsDelegate<O> {\n  useLayoutOptions?(): O\n}\n\ninterface ILayout<O> extends Layout<Node<unknown>, O>, Partial<DropTargetDelegate>, LayoutOptionsDelegate<O> {}\n\nexport interface VirtualizerProps<O> {\n  /** The child collection to virtualize (e.g. ListBox, GridList, or Table). */\n  children: ReactNode,\n  /** The layout object that determines the position and size of the visible elements. */\n  layout: ILayout<O>,\n  /** Options for the layout. */\n  layoutOptions?: O\n}\n\nconst VirtualizerContext = createContext<VirtualizerState<any, any> | null>(null);\nconst LayoutContext = createContext<Pick<VirtualizerProps<any>, 'layout' | 'layoutOptions'> | null>(null);\n\nexport function Virtualizer<O>(props: VirtualizerProps<O>) {\n  let {children, layout, layoutOptions} = props;\n  let renderer: CollectionRenderer = useMemo(() => ({\n    isVirtualized: true,\n    layoutDelegate: layout,\n    dropTargetDelegate: layout.getDropTargetFromPoint ? layout as DropTargetDelegate : undefined,\n    CollectionRoot,\n    CollectionBranch\n  }), [layout]);\n\n  return (\n    <CollectionRendererContext.Provider value={renderer}>\n      <LayoutContext.Provider value={{layout, layoutOptions}}>\n        {children}\n      </LayoutContext.Provider>\n    </CollectionRendererContext.Provider>\n  );\n}\n\nfunction CollectionRoot({collection, persistedKeys, scrollRef, renderDropIndicator}: CollectionRootProps) {\n  let {layout, layoutOptions} = useContext(LayoutContext)!;\n  let layoutOptions2 = layout.useLayoutOptions?.();\n  let state = useVirtualizerState({\n    layout,\n    collection,\n    renderView: (type, item) => {\n      return item?.render?.(item);\n    },\n    onVisibleRectChange(rect) {\n      let element = scrollRef?.current;\n      if (element) {\n        element.scrollLeft = rect.x;\n        element.scrollTop = rect.y;\n      }\n    },\n    persistedKeys,\n    layoutOptions: useMemo(() => {\n      if (layoutOptions && layoutOptions2) {\n        return {...layoutOptions, ...layoutOptions2};\n      }\n      return layoutOptions || layoutOptions2;\n    }, [layoutOptions, layoutOptions2])\n  });\n\n  let {contentProps} = useScrollView({\n    onVisibleRectChange: state.setVisibleRect,\n    contentSize: state.contentSize,\n    onScrollStart: state.startScrolling,\n    onScrollEnd: state.endScrolling\n  }, scrollRef!);\n\n  if (state.contentSize.area === 0) {\n    return null;\n  }\n\n  return (\n    <div {...contentProps}>\n      <VirtualizerContext.Provider value={state}>\n        {renderChildren(null, state.visibleViews, renderDropIndicator)}\n      </VirtualizerContext.Provider>\n    </div>\n  );\n}\n\nfunction CollectionBranch({parent, renderDropIndicator}: CollectionBranchProps) {\n  let virtualizer = useContext(VirtualizerContext);\n  let parentView = virtualizer!.virtualizer.getVisibleView(parent.key)!;\n  return renderChildren(parentView, Array.from(parentView.children), renderDropIndicator);\n}\n\nfunction renderChildren(parent: View | null, children: View[], renderDropIndicator?: (target: ItemDropTarget) => ReactNode) {\n  return children.map(view => renderWrapper(parent, view, renderDropIndicator));\n}\n\nfunction renderWrapper(\n  parent: View | null,\n  reusableView: View,\n  renderDropIndicator?: (target: ItemDropTarget) => ReactNode\n): ReactElement {\n  let rendered = (\n    <VirtualizerItem\n      key={reusableView.key}\n      layoutInfo={reusableView.layoutInfo!}\n      virtualizer={reusableView.virtualizer}\n      parent={parent?.layoutInfo}>\n      {reusableView.rendered}\n    </VirtualizerItem>\n  );\n\n  let {collection, layout} = reusableView.virtualizer;\n  let {key, type} = reusableView.content;\n  if (type === 'item' && renderDropIndicator && layout.getDropTargetLayoutInfo) {\n    rendered = (\n      <React.Fragment key={reusableView.key}>\n        {renderDropIndicatorWrapper(parent, reusableView, 'before', renderDropIndicator)}\n        {rendered}\n        {collection.getKeyAfter(key) == null && renderDropIndicatorWrapper(parent, reusableView, 'after', renderDropIndicator)}\n      </React.Fragment>\n    );\n  }\n\n  return rendered;\n}\n\nfunction renderDropIndicatorWrapper(\n  parent: View | null,\n  reusableView: View,\n  dropPosition: DropPosition,\n  renderDropIndicator: (target: ItemDropTarget) => ReactNode\n) {\n  let target: DropTarget = {type: 'item', key: reusableView.content.key, dropPosition};\n  let indicator = renderDropIndicator(target);\n  if (indicator) {\n    let layoutInfo = reusableView.virtualizer.layout.getDropTargetLayoutInfo!(target);\n    indicator = (\n      <VirtualizerItem\n        layoutInfo={layoutInfo}\n        virtualizer={reusableView.virtualizer}\n        parent={parent?.layoutInfo}>\n        {indicator}\n      </VirtualizerItem>\n    );\n  }\n\n  return indicator;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}