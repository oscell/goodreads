{"ast":null,"code":"import { ScrollView as $44a6ee657928b002$export$5665e3d6be6adea } from \"./ScrollView.mjs\";\nimport { VirtualizerItem as $ccf8a0a04e4175ae$export$6796df8ba7398521 } from \"./VirtualizerItem.mjs\";\nimport { useVirtualizerState as $9WwqA$useVirtualizerState } from \"@react-stately/virtualizer\";\nimport { useLoadMore as $9WwqA$useLoadMore, mergeProps as $9WwqA$mergeProps } from \"@react-aria/utils\";\nimport $9WwqA$react, { useRef as $9WwqA$useRef, useCallback as $9WwqA$useCallback } from \"react\";\n\n/*\n * Copyright 2020 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nfunction $6d0a5c394373ae64$var$Virtualizer(props, ref) {\n  let {\n    children: renderView,\n    renderWrapper: renderWrapper,\n    layout: layout,\n    collection: collection,\n    scrollDirection: scrollDirection,\n    isLoading:\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    isLoading,\n    onLoadMore:\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    onLoadMore,\n    persistedKeys: persistedKeys,\n    layoutOptions: layoutOptions,\n    ...otherProps\n  } = props;\n  let fallbackRef = (0, $9WwqA$useRef)(undefined);\n  ref = ref || fallbackRef;\n  let state = (0, $9WwqA$useVirtualizerState)({\n    layout: layout,\n    collection: collection,\n    renderView: renderView,\n    onVisibleRectChange(rect) {\n      ref.current.scrollLeft = rect.x;\n      ref.current.scrollTop = rect.y;\n    },\n    persistedKeys: persistedKeys,\n    layoutOptions: layoutOptions\n  });\n  (0, $9WwqA$useLoadMore)({\n    isLoading: isLoading,\n    onLoadMore: onLoadMore,\n    scrollOffset: 1\n  }, ref);\n  let onVisibleRectChange = (0, $9WwqA$useCallback)(rect => {\n    state.setVisibleRect(rect);\n  }, [state]);\n  return /*#__PURE__*/(0, $9WwqA$react).createElement((0, $44a6ee657928b002$export$5665e3d6be6adea), {\n    ...(0, $9WwqA$mergeProps)(otherProps, {\n      onVisibleRectChange: onVisibleRectChange\n    }),\n    ref: ref,\n    contentSize: state.contentSize,\n    onScrollStart: state.startScrolling,\n    onScrollEnd: state.endScrolling,\n    scrollDirection: scrollDirection\n  }, $6d0a5c394373ae64$var$renderChildren(null, state.visibleViews, renderWrapper || $6d0a5c394373ae64$var$defaultRenderWrapper));\n}\n// forwardRef doesn't support generic parameters, so cast the result to the correct type\n// https://stackoverflow.com/questions/58469229/react-with-typescript-generics-while-using-react-forwardref\nconst $6d0a5c394373ae64$export$89be5a243e59c4b2 = /*#__PURE__*/(0, $9WwqA$react).forwardRef($6d0a5c394373ae64$var$Virtualizer);\nfunction $6d0a5c394373ae64$var$renderChildren(parent, views, renderWrapper) {\n  return views.map(view => {\n    return renderWrapper(parent, view, view.children ? Array.from(view.children) : [], childViews => $6d0a5c394373ae64$var$renderChildren(view, childViews, renderWrapper));\n  });\n}\nfunction $6d0a5c394373ae64$var$defaultRenderWrapper(parent, reusableView) {\n  return /*#__PURE__*/(0, $9WwqA$react).createElement((0, $ccf8a0a04e4175ae$export$6796df8ba7398521), {\n    key: reusableView.key,\n    layoutInfo: reusableView.layoutInfo,\n    virtualizer: reusableView.virtualizer,\n    parent: parent === null || parent === void 0 ? void 0 : parent.layoutInfo\n  }, reusableView.rendered);\n}\nexport { $6d0a5c394373ae64$export$89be5a243e59c4b2 as Virtualizer };","map":{"version":3,"names":["$6d0a5c394373ae64$var$Virtualizer","props","ref","children","renderView","renderWrapper","layout","collection","scrollDirection","isLoading","onLoadMore","persistedKeys","layoutOptions","otherProps","fallbackRef","$9WwqA$useRef","undefined","state","$9WwqA$useVirtualizerState","onVisibleRectChange","rect","current","scrollLeft","x","scrollTop","y","$9WwqA$useLoadMore","scrollOffset","$9WwqA$useCallback","setVisibleRect","$9WwqA$react","createElement","$44a6ee657928b002$export$5665e3d6be6adea","$9WwqA$mergeProps","contentSize","onScrollStart","startScrolling","onScrollEnd","endScrolling","$6d0a5c394373ae64$var$renderChildren","visibleViews","$6d0a5c394373ae64$var$defaultRenderWrapper","$6d0a5c394373ae64$export$89be5a243e59c4b2","forwardRef","parent","views","map","view","Array","from","childViews","reusableView","$ccf8a0a04e4175ae$export$6796df8ba7398521","key","layoutInfo","virtualizer","rendered"],"sources":["/Users/oscar.meunier/Documents/Personal/goodreads/node_modules/@react-aria/virtualizer/dist/packages/@react-aria/virtualizer/src/Virtualizer.tsx"],"sourcesContent":["/*\n * Copyright 2020 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport {Collection, Key, RefObject} from '@react-types/shared';\nimport {Layout, Rect, ReusableView, useVirtualizerState} from '@react-stately/virtualizer';\nimport {mergeProps, useLoadMore} from '@react-aria/utils';\nimport React, {HTMLAttributes, ReactElement, ReactNode, useCallback, useRef} from 'react';\nimport {ScrollView} from './ScrollView';\nimport {VirtualizerItem} from './VirtualizerItem';\n\ntype RenderWrapper<T extends object, V> = (\n  parent: ReusableView<T, V> | null,\n  reusableView: ReusableView<T, V>,\n  children: ReusableView<T, V>[],\n  renderChildren: (views: ReusableView<T, V>[]) => ReactElement[]\n) => ReactElement;\n\ninterface VirtualizerProps<T extends object, V, O> extends Omit<HTMLAttributes<HTMLElement>, 'children'> {\n  children: (type: string, content: T) => V,\n  renderWrapper?: RenderWrapper<T, V>,\n  layout: Layout<T, O>,\n  collection: Collection<T>,\n  persistedKeys?: Set<Key> | null,\n  scrollDirection?: 'horizontal' | 'vertical' | 'both',\n  isLoading?: boolean,\n  onLoadMore?: () => void,\n  layoutOptions?: O\n}\n\nfunction Virtualizer<T extends object, V extends ReactNode, O>(props: VirtualizerProps<T, V, O>, ref: RefObject<HTMLDivElement | null>) {\n  let {\n    children: renderView,\n    renderWrapper,\n    layout,\n    collection,\n    scrollDirection,\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    isLoading,\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    onLoadMore,\n    persistedKeys,\n    layoutOptions,\n    ...otherProps\n  } = props;\n\n  let fallbackRef = useRef<HTMLDivElement>(undefined);\n  ref = ref || fallbackRef;\n\n  let state = useVirtualizerState({\n    layout,\n    collection,\n    renderView,\n    onVisibleRectChange(rect) {\n      ref.current.scrollLeft = rect.x;\n      ref.current.scrollTop = rect.y;\n    },\n    persistedKeys,\n    layoutOptions\n  });\n\n  useLoadMore({isLoading, onLoadMore, scrollOffset: 1}, ref);\n  let onVisibleRectChange = useCallback((rect: Rect) => {\n    state.setVisibleRect(rect);\n  }, [state]);\n\n  return (\n    <ScrollView\n      {...mergeProps(otherProps, {onVisibleRectChange})}\n      ref={ref}\n      contentSize={state.contentSize}\n      onScrollStart={state.startScrolling}\n      onScrollEnd={state.endScrolling}\n      scrollDirection={scrollDirection}>\n      {renderChildren(null, state.visibleViews, renderWrapper || defaultRenderWrapper)}\n    </ScrollView>\n  );\n}\n\n// forwardRef doesn't support generic parameters, so cast the result to the correct type\n// https://stackoverflow.com/questions/58469229/react-with-typescript-generics-while-using-react-forwardref\nconst _Virtualizer = React.forwardRef(Virtualizer) as <T extends object, V, O>(props: VirtualizerProps<T, V, O> & {ref?: RefObject<HTMLDivElement | null>}) => ReactElement;\nexport {_Virtualizer as Virtualizer};\n\nfunction renderChildren<T extends object, V>(parent: ReusableView<T, V> | null, views: ReusableView<T, V>[], renderWrapper: RenderWrapper<T, V>) {\n  return views.map(view => {\n    return renderWrapper(\n      parent,\n      view,\n      view.children ? Array.from(view.children) : [],\n      childViews => renderChildren(view, childViews, renderWrapper)\n    );\n  });\n}\n\nfunction defaultRenderWrapper<T extends object, V extends ReactNode>(\n  parent: ReusableView<T, V> | null,\n  reusableView: ReusableView<T, V>\n) {\n  return (\n    <VirtualizerItem\n      key={reusableView.key}\n      layoutInfo={reusableView.layoutInfo}\n      virtualizer={reusableView.virtualizer}\n      parent={parent?.layoutInfo}>\n      {reusableView.rendered}\n    </VirtualizerItem>\n  );\n}\n"],"mappings":";;;;;;AAAA;;;;;;;;;;;;AAsCA,SAASA,kCAAsDC,KAAgC,EAAEC,GAAqC;EACpI,IAAI;IACFC,QAAA,EAAUC,UAAU;IAAAC,aAAA,EACpBA,aAAa;IAAAC,MAAA,EACbA,MAAM;IAAAC,UAAA,EACNA,UAAU;IAAAC,eAAA,EACVA,eAAe;IAAAC,SAAA;IACf;IACAA,SAAS;IAAAC,UAAA;IACT;IACAA,UAAU;IAAAC,aAAA,EACVA,aAAa;IAAAC,aAAA,EACbA,aAAa;IACb,GAAGC;EAAA,CACJ,GAAGZ,KAAA;EAEJ,IAAIa,WAAA,GAAc,IAAAC,aAAK,EAAkBC,SAAA;EACzCd,GAAA,GAAMA,GAAA,IAAOY,WAAA;EAEb,IAAIG,KAAA,GAAQ,IAAAC,0BAAkB,EAAE;YAC9BZ,MAAA;gBACAC,UAAA;gBACAH,UAAA;IACAe,oBAAoBC,IAAI;MACtBlB,GAAA,CAAImB,OAAO,CAACC,UAAU,GAAGF,IAAA,CAAKG,CAAC;MAC/BrB,GAAA,CAAImB,OAAO,CAACG,SAAS,GAAGJ,IAAA,CAAKK,CAAC;IAChC;mBACAd,aAAA;mBACAC;EACF;EAEA,IAAAc,kBAAU,EAAE;eAACjB,SAAA;gBAAWC,UAAA;IAAYiB,YAAA,EAAc;EAAC,GAAGzB,GAAA;EACtD,IAAIiB,mBAAA,GAAsB,IAAAS,kBAAU,EAAGR,IAAA;IACrCH,KAAA,CAAMY,cAAc,CAACT,IAAA;EACvB,GAAG,CAACH,KAAA,CAAM;EAEV,oBACE,IAAAa,YAAA,EAAAC,aAAA,EAAC,GAAAC,wCAAS;IACP,GAAG,IAAAC,iBAAS,EAAEpB,UAAA,EAAY;2BAACM;IAAmB,EAAE;IACjDjB,GAAA,EAAKA,GAAA;IACLgC,WAAA,EAAajB,KAAA,CAAMiB,WAAW;IAC9BC,aAAA,EAAelB,KAAA,CAAMmB,cAAc;IACnCC,WAAA,EAAapB,KAAA,CAAMqB,YAAY;IAC/B9B,eAAA,EAAiBA;KAChB+B,oCAAA,CAAe,MAAMtB,KAAA,CAAMuB,YAAY,EAAEnC,aAAA,IAAiBoC,0CAAA;AAGjE;AAEA;AACA;AACA,MAAMC,yCAAA,gBAAe,IAAAZ,YAAI,EAAEa,UAAU,CAAC3C,iCAAA;AAGtC,SAASuC,qCAAoCK,MAAiC,EAAEC,KAA2B,EAAExC,aAAkC;EAC7I,OAAOwC,KAAA,CAAMC,GAAG,CAACC,IAAA;IACf,OAAO1C,aAAA,CACLuC,MAAA,EACAG,IAAA,EACAA,IAAA,CAAK5C,QAAQ,GAAG6C,KAAA,CAAMC,IAAI,CAACF,IAAA,CAAK5C,QAAQ,IAAI,EAAE,EAC9C+C,UAAA,IAAcX,oCAAA,CAAeQ,IAAA,EAAMG,UAAA,EAAY7C,aAAA;EAEnD;AACF;AAEA,SAASoC,2CACPG,MAAiC,EACjCO,YAAgC;EAEhC,oBACE,IAAArB,YAAA,EAAAC,aAAA,EAAC,GAAAqB,yCAAc;IACbC,GAAA,EAAKF,YAAA,CAAaE,GAAG;IACrBC,UAAA,EAAYH,YAAA,CAAaG,UAAU;IACnCC,WAAA,EAAaJ,YAAA,CAAaI,WAAW;IACrCX,MAAM,EAAEA,MAAA,aAAAA,MAAA,uBAAAA,MAAA,CAAQU;KACfH,YAAA,CAAaK,QAAQ;AAG5B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}