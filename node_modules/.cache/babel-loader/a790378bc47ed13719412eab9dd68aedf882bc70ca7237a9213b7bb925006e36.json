{"ast":null,"code":"import { MenuContext as $d94604d52c3e3feb$export$c7e742effb1c51e2, SubmenuTriggerContext as $d94604d52c3e3feb$export$8d97fe02339fc0e3, useMenuStateContext as $d94604d52c3e3feb$export$efa3856fc0e85e7f } from \"./context.mjs\";\nimport \"./vars.a1f9fd59.css\";\nimport $byZ4r$menu_vars_cssmodulejs from \"./menu_vars_css.mjs\";\nimport { useIsMobileDevice as $byZ4r$useIsMobileDevice, classNames as $byZ4r$classNames } from \"@react-spectrum/utils\";\nimport { mergeProps as $byZ4r$mergeProps } from \"@react-aria/utils\";\nimport { Popover as $byZ4r$Popover } from \"@react-spectrum/overlays\";\nimport $byZ4r$react, { useRef as $byZ4r$useRef } from \"react\";\nimport $byZ4r$reactdom from \"react-dom\";\nimport { useLocale as $byZ4r$useLocale } from \"@react-aria/i18n\";\nimport { useSubmenuTrigger as $byZ4r$useSubmenuTrigger } from \"@react-aria/menu\";\nimport { useSubmenuTriggerState as $byZ4r$useSubmenuTriggerState } from \"@react-stately/menu\";\nfunction $parcel$interopDefault(a) {\n  return a && a.__esModule ? a.default : a;\n}\n/*\n * Copyright 2020 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nfunction $3f13e15cf95c3893$var$SubmenuTrigger(props) {\n  let triggerRef = (0, $byZ4r$useRef)(undefined);\n  let {\n    children: children,\n    targetKey: targetKey\n  } = props;\n  let [menuTrigger, menu] = (0, $byZ4r$react).Children.toArray(children);\n  let {\n    popoverContainer: popoverContainer,\n    trayContainerRef: trayContainerRef,\n    menu: parentMenuRef,\n    submenu: menuRef,\n    rootMenuTriggerState: rootMenuTriggerState\n  } = (0, $d94604d52c3e3feb$export$efa3856fc0e85e7f)();\n  let submenuTriggerState = (0, $byZ4r$useSubmenuTriggerState)({\n    triggerKey: targetKey\n  }, rootMenuTriggerState);\n  let {\n    submenuTriggerProps: submenuTriggerProps,\n    submenuProps: submenuProps,\n    popoverProps: popoverProps\n  } = (0, $byZ4r$useSubmenuTrigger)({\n    parentMenuRef: parentMenuRef,\n    submenuRef: menuRef\n  }, submenuTriggerState, triggerRef);\n  let isMobile = (0, $byZ4r$useIsMobileDevice)();\n  let onBackButtonPress = () => {\n    submenuTriggerState.close();\n    if (parentMenuRef.current && !parentMenuRef.current.contains(document.activeElement)) parentMenuRef.current.focus();\n  };\n  let {\n    direction: direction\n  } = (0, $byZ4r$useLocale)();\n  let mobileSubmenuKeyDown = e => {\n    switch (e.key) {\n      case 'ArrowLeft':\n        if (direction === 'ltr') triggerRef.current.focus();\n        break;\n      case 'ArrowRight':\n        if (direction === 'rtl') triggerRef.current.focus();\n        break;\n    }\n  };\n  let overlay;\n  if (isMobile) {\n    var _submenuProps;\n    delete submenuTriggerProps.onBlur;\n    delete submenuTriggerProps.onHoverChange;\n    var _autoFocus;\n    (_autoFocus = (_submenuProps = submenuProps).autoFocus) !== null && _autoFocus !== void 0 ? _autoFocus : _submenuProps.autoFocus = true;\n    if (trayContainerRef.current && submenuTriggerState.isOpen) overlay = /*#__PURE__*/(0, $byZ4r$reactdom).createPortal(menu, trayContainerRef.current);\n  } else {\n    let onDismissButtonPress = () => {\n      var _parentMenuRef_current;\n      submenuTriggerState.close();\n      (_parentMenuRef_current = parentMenuRef.current) === null || _parentMenuRef_current === void 0 ? void 0 : _parentMenuRef_current.focus();\n    };\n    overlay = /*#__PURE__*/(0, $byZ4r$react).createElement((0, $byZ4r$Popover), {\n      ...popoverProps,\n      onDismissButtonPress: onDismissButtonPress,\n      UNSAFE_className: (0, $byZ4r$classNames)((0, $parcel$interopDefault($byZ4r$menu_vars_cssmodulejs)), 'spectrum-Submenu-popover'),\n      container: popoverContainer,\n      containerPadding: 0,\n      enableBothDismissButtons: true,\n      UNSAFE_style: {\n        clipPath: 'unset',\n        overflow: 'visible',\n        borderWidth: '0px'\n      },\n      state: submenuTriggerState,\n      triggerRef: triggerRef,\n      scrollRef: menuRef,\n      placement: \"end top\",\n      hideArrow: true\n    }, menu);\n  }\n  let menuContext = {\n    ...(0, $byZ4r$mergeProps)(submenuProps, {\n      ref: menuRef,\n      UNSAFE_style: isMobile ? {\n        width: '100%',\n        maxHeight: 'inherit'\n      } : undefined,\n      UNSAFE_className: (0, $byZ4r$classNames)((0, $parcel$interopDefault($byZ4r$menu_vars_cssmodulejs)), {\n        'spectrum-Menu-popover': !isMobile\n      }),\n      ...(isMobile && {\n        onBackButtonPress: onBackButtonPress,\n        onKeyDown: mobileSubmenuKeyDown\n      })\n    })\n  };\n  return /*#__PURE__*/(0, $byZ4r$react).createElement((0, $byZ4r$react).Fragment, null, /*#__PURE__*/(0, $byZ4r$react).createElement((0, $d94604d52c3e3feb$export$8d97fe02339fc0e3).Provider, {\n    value: {\n      triggerRef: triggerRef,\n      ...submenuTriggerProps\n    }\n  }, menuTrigger), /*#__PURE__*/(0, $byZ4r$react).createElement((0, $d94604d52c3e3feb$export$c7e742effb1c51e2).Provider, {\n    value: menuContext\n  }, overlay));\n}\n$3f13e15cf95c3893$var$SubmenuTrigger.getCollectionNode = function* (props) {\n  let childArray = [];\n  (0, $byZ4r$react).Children.forEach(props.children, child => {\n    if (/*#__PURE__*/(0, $byZ4r$react).isValidElement(child)) childArray.push(child);\n  });\n  let [trigger] = childArray;\n  let [, content] = props.children;\n  yield {\n    element: /*#__PURE__*/(0, $byZ4r$react).cloneElement(trigger, {\n      ...trigger.props,\n      hasChildItems: true,\n      isTrigger: true\n    }),\n    wrapper: element => /*#__PURE__*/(0, $byZ4r$react).createElement($3f13e15cf95c3893$var$SubmenuTrigger, {\n      key: element.key,\n      targetKey: element.key,\n      ...props\n    }, element, content)\n  };\n};\nlet $3f13e15cf95c3893$export$ecabc99eeffab7ca = $3f13e15cf95c3893$var$SubmenuTrigger;\nexport { $3f13e15cf95c3893$export$ecabc99eeffab7ca as SubmenuTrigger };","map":{"version":3,"names":["$3f13e15cf95c3893$var$SubmenuTrigger","props","triggerRef","$byZ4r$useRef","undefined","children","targetKey","menuTrigger","menu","$byZ4r$react","Children","toArray","popoverContainer","trayContainerRef","parentMenuRef","submenu","menuRef","rootMenuTriggerState","$d94604d52c3e3feb$export$efa3856fc0e85e7f","submenuTriggerState","$byZ4r$useSubmenuTriggerState","triggerKey","submenuTriggerProps","submenuProps","popoverProps","$byZ4r$useSubmenuTrigger","submenuRef","isMobile","$byZ4r$useIsMobileDevice","onBackButtonPress","close","current","contains","document","activeElement","focus","direction","$byZ4r$useLocale","mobileSubmenuKeyDown","e","key","overlay","_submenuProps","onBlur","onHoverChange","_autoFocus","autoFocus","isOpen","$byZ4r$reactdom","createPortal","onDismissButtonPress","_parentMenuRef_current","createElement","$byZ4r$Popover","UNSAFE_className","$byZ4r$classNames","$parcel$interopDefault","$byZ4r$menu_vars_cssmodulejs","container","containerPadding","enableBothDismissButtons","UNSAFE_style","clipPath","overflow","borderWidth","state","scrollRef","placement","hideArrow","menuContext","$byZ4r$mergeProps","ref","width","maxHeight","onKeyDown","Fragment","$d94604d52c3e3feb$export$8d97fe02339fc0e3","Provider","value","$d94604d52c3e3feb$export$c7e742effb1c51e2","getCollectionNode","childArray","forEach","child","isValidElement","push","trigger","content","element","cloneElement","hasChildItems","isTrigger","wrapper","$3f13e15cf95c3893$export$ecabc99eeffab7ca"],"sources":["/Users/oscar.meunier/Documents/Personal/goodreads/node_modules/@react-spectrum/menu/dist/packages/@react-spectrum/menu/src/SubmenuTrigger.tsx"],"sourcesContent":["/*\n * Copyright 2020 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport {classNames, useIsMobileDevice} from '@react-spectrum/utils';\nimport {Key} from '@react-types/shared';\nimport {MenuContext, SubmenuTriggerContext, useMenuStateContext} from './context';\nimport {mergeProps} from '@react-aria/utils';\nimport {Popover} from '@react-spectrum/overlays';\nimport React, {type JSX, ReactElement, useRef} from 'react';\nimport ReactDOM from 'react-dom';\nimport styles from '@adobe/spectrum-css-temp/components/menu/vars.css';\nimport {useLocale} from '@react-aria/i18n';\nimport {useSubmenuTrigger} from '@react-aria/menu';\nimport {useSubmenuTriggerState} from '@react-stately/menu';\n\ninterface SubmenuTriggerProps {\n  /**\n   * The contents of the SubmenuTrigger - an Item and a Menu.\n   */\n  children: ReactElement<any>[],\n  targetKey: Key\n}\n\nexport interface SpectrumSubmenuTriggerProps extends Omit<SubmenuTriggerProps, 'targetKey'> {}\n\nfunction SubmenuTrigger(props: SubmenuTriggerProps) {\n  let triggerRef = useRef<HTMLDivElement>(undefined);\n  let {\n    children,\n    targetKey\n  } = props;\n\n  let [menuTrigger, menu] = React.Children.toArray(children);\n  let {popoverContainer, trayContainerRef, menu: parentMenuRef, submenu: menuRef, rootMenuTriggerState} = useMenuStateContext();\n  let submenuTriggerState = useSubmenuTriggerState({triggerKey: targetKey}, rootMenuTriggerState);\n  let {submenuTriggerProps, submenuProps, popoverProps} = useSubmenuTrigger({\n    parentMenuRef,\n    submenuRef: menuRef\n  }, submenuTriggerState, triggerRef);\n  let isMobile = useIsMobileDevice();\n  let onBackButtonPress = () => {\n    submenuTriggerState.close();\n    if (parentMenuRef.current && !parentMenuRef.current.contains(document.activeElement)) {\n      parentMenuRef.current.focus();\n    }\n  };\n\n  let {direction} = useLocale();\n  let mobileSubmenuKeyDown = (e: KeyboardEvent) => {\n    switch (e.key) {\n      case 'ArrowLeft':\n        if (direction === 'ltr') {\n          triggerRef.current.focus();\n        }\n        break;\n      case 'ArrowRight':\n        if (direction === 'rtl') {\n          triggerRef.current.focus();\n        }\n        break;\n    }\n  };\n\n  let overlay;\n\n  if (isMobile)  {\n    delete submenuTriggerProps.onBlur;\n    delete submenuTriggerProps.onHoverChange;\n    submenuProps.autoFocus ??= true;\n    if (trayContainerRef.current && submenuTriggerState.isOpen) {\n      overlay = ReactDOM.createPortal(menu, trayContainerRef.current);\n    }\n  } else {\n    let onDismissButtonPress = () => {\n      submenuTriggerState.close();\n      parentMenuRef.current?.focus();\n    };\n\n    overlay = (\n      <Popover\n        {...popoverProps}\n        onDismissButtonPress={onDismissButtonPress}\n        UNSAFE_className={classNames(styles, 'spectrum-Submenu-popover')}\n        container={popoverContainer}\n        containerPadding={0}\n        enableBothDismissButtons\n        UNSAFE_style={{clipPath: 'unset', overflow: 'visible', borderWidth: '0px'}}\n        state={submenuTriggerState}\n        triggerRef={triggerRef}\n        scrollRef={menuRef}\n        placement=\"end top\"\n        hideArrow>\n        {menu}\n      </Popover>\n    );\n  }\n\n  let menuContext = {\n    ...mergeProps(submenuProps, {\n      ref: menuRef,\n      UNSAFE_style: isMobile ? {\n        width: '100%',\n        maxHeight: 'inherit'\n      } : undefined,\n      UNSAFE_className: classNames(styles, {'spectrum-Menu-popover': !isMobile}),\n      ...(isMobile && {\n        onBackButtonPress,\n        onKeyDown: mobileSubmenuKeyDown\n      })\n    })\n  };\n\n  return (\n    <>\n      <SubmenuTriggerContext.Provider value={{triggerRef, ...submenuTriggerProps}}>{menuTrigger}</SubmenuTriggerContext.Provider>\n      <MenuContext.Provider value={menuContext}>\n        {overlay}\n      </MenuContext.Provider>\n    </>\n  );\n}\n\nSubmenuTrigger.getCollectionNode = function* (props: SpectrumSubmenuTriggerProps) {\n  let childArray: ReactElement[] = [];\n  React.Children.forEach(props.children, child => {\n    if (React.isValidElement(child)) {\n      childArray.push(child);\n    }\n  });\n  let [trigger] = childArray;\n  let [, content] = props.children as [ReactElement, ReactElement];\n\n  yield {\n    element: React.cloneElement(trigger, {...trigger.props as any, hasChildItems: true, isTrigger: true}),\n    wrapper: (element) => (\n      <SubmenuTrigger key={element.key} targetKey={element.key} {...props}>\n        {element}\n        {content}\n      </SubmenuTrigger>\n    )\n  };\n};\n\nlet _SubmenuTrigger = SubmenuTrigger as (props: SpectrumSubmenuTriggerProps) => JSX.Element;\nexport {_SubmenuTrigger as SubmenuTrigger};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}